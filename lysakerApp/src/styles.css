/* ===== BASE VARIABLER (fallback før data-theme settes) ===== */
:root{
  --bg:#0f1320; --bg-grad-1:#121936; --bg-grad-2:#0f1320;
  --panel:#171d32; --panel-2:#141a2c; --glass: rgba(255,255,255,0.06); --line:#2a3556;
  --text:#f2f4fa; --muted:#bcc6dc; --ok:#37e0b0; --warn:#ffd666; --danger:#ff8a8a;

  --icon-sun:#ffd666;
  --icon-cloud:#d9e2ff;
  --icon-rain:#8fb6ff;
  --icon-snow:#e6f0ff;
  --icon-thunder:#ffdd77;
  --icon-transport:#f2f4fa;
}

/* ===== LAYOUT (samme på tvers av tema) ===== */
*{ box-sizing:border-box }
html, body, #root {
  height:100dvh; margin:0; overflow:hidden;
  background:
    radial-gradient(1200px 900px at 15% 0%, var(--bg-grad-1) 0%, var(--bg-grad-2) 60%) no-repeat,
    var(--bg);
  color: var(--text);
}
body{ font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }

h1{ font-size: clamp(1.6rem, 2.8vw, 2.4rem); margin:0 0 .25rem }
h2{ font-size: clamp(1.1rem, 1.8vw, 1.55rem); margin:0 }
.page{ height:100%; display:grid; grid-template-rows:auto 1fr auto; }
.container{ width: min(1400px, 95vw); margin-inline:auto; }

header{ padding: clamp(10px, 2vh, 20px) 0 clamp(6px, 1vh, 12px); }
.header-row{ display:flex; align-items:flex-end; justify-content:space-between; gap:16px; }
.clock{ font-variant-numeric: tabular-nums; font-weight:600; font-size: clamp(1.1rem, 2.2vw, 1.9rem); }

main.container{
  height:100%;
  display:grid; gap: clamp(14px, 2vw, 28px);
  grid-template-columns: 1fr;
}
@media (min-width: 1100px){ main.container{ grid-template-columns: 1fr 1fr; } }

/* Card */
.card{
  height:100%;
  display:flex; flex-direction:column; min-height:0;
  border-radius:22px;
  box-shadow: 0 18px 48px rgba(0,0,0,.25);
  padding: clamp(14px, 2vw, 24px);
  backdrop-filter: blur(6px) saturate(120%);
  border:1px solid var(--line);
  background: linear-gradient(180deg, var(--panel), var(--panel-2));
}
.card-header{
  display:flex; align-items:baseline; justify-content:space-between;
  margin-bottom: clamp(8px, 1.2vh, 16px);
}
.updated{ color:var(--muted); font-size: clamp(.85rem, 1.2vw, 1rem) }

/* Lists – ingen scroll; vi renderer kun det som får plass */
.panel-body{ flex:1 1 auto; min-height:0; display:grid; }
.list{ align-content:start; display:grid; gap: clamp(10px, 1.5vw, 18px); }

/* Rad: ikon | tid | linje-pill | dest/meta | status */
.row{
  display:grid; align-items:center; gap: clamp(10px, 1.4vw, 18px);
  grid-template-columns: clamp(44px, 3.4vw, 58px) clamp(100px, 9vw, 132px) auto 1fr auto;
  background: linear-gradient(180deg, var(--glass), rgba(255,255,255,0.03));
  border:1px solid var(--line);
  border-radius:16px;
  box-shadow: 0 10px 24px rgba(0,0,0,.20);
  padding: clamp(10px, 1.6vw, 16px) clamp(12px, 1.8vw, 20px);
}

/* SVG-ikonbeholder */
.icon{
  width: clamp(42px, 3.2vw, 56px); height: clamp(42px, 3.2vw, 56px);
  display:grid; place-items:center;
  border-radius: 14px;
  background: var(--panel-2); border:1px solid var(--line);
}

/* Tidskolonne (forsinkelse: strøket aimed + ny expected) */
.time{ font-variant-numeric: tabular-nums; color:var(--muted); font-size: clamp(1rem, 1.5vw, 1.15rem) }
.time-col{ display:flex; flex-direction:column; line-height:1.05 }
.time-aimed{ color: var(--muted); opacity:.85; }
.strike{ text-decoration: line-through; text-decoration-thickness: 2px; text-decoration-color: rgba(255,255,255,.35); }
.time-expected{ color: var(--text); font-weight: 800; font-size: clamp(1.05rem, 1.6vw, 1.25rem); }

/* Linje-pill */
.line-pill{
  justify-self: start;
  display:inline-flex; align-items:center;
  padding: .35em .75em;
  font-weight:800; letter-spacing:.2px;
  border-radius: 999px;
  font-size: clamp(.95rem, 1.5vw, 1.1rem);
  text-transform: uppercase;
  color:#fff;
}

/* Tekst */
.title{ font-weight:700; font-size: clamp(1.05rem, 1.6vw, 1.3rem); letter-spacing:.1px }
.meta{ color:var(--muted); font-size: clamp(.92rem, 1.3vw, 1.05rem) }

/* Badges (status) */
.badge{
  display:inline-flex; align-items:center; gap:.5ch;
  padding:.45em .85em; border-radius:999px; font-size: clamp(.85rem, 1.4vw, 1rem);
  border:1px solid var(--line); background: var(--panel-2); color:var(--text);
}
.badge.ok{ background:var(--ok); color:#000; border-color: transparent; }
.badge.warn{ background:var(--warn); color:#000; border-color: transparent; }
.badge.danger{ background:var(--danger); color:#000; border-color: transparent; }

.loading,.error{ padding:.8em; border-radius:14px; }
.loading{ background:var(--panel-2); border:1px dashed var(--line); color:var(--muted) }
.error{ background:#3a2030; border:1px solid #5a2a3b; color:#ffd8de }

footer{ padding: clamp(8px, 1.6vh, 22px) 0 clamp(10px, 2vh, 28px); text-align:center; }

/* ===== FARGER PR. TEMA ===== */

/* dark */
:root[data-theme="dark"]{
  --bg:#0f1320; --bg-grad-1:#121936; --bg-grad-2:#0f1320;
  --panel:#171d32; --panel-2:#141a2c; --glass: rgba(255,255,255,0.06); --line:#2a3556;
  --text:#f2f4fa; --muted:#bcc6dc; --ok:#37e0b0; --warn:#ffd666; --danger:#ff8a8a;

  --icon-sun:#ffd666;
  --icon-cloud:#d9e2ff;
  --icon-rain:#8fb6ff;
  --icon-snow:#e6f0ff;
  --icon-thunder:#ffdd77;
  --icon-transport:#f2f4fa;
}

/* light */
:root[data-theme="light"]{
  --bg:#f7f9ff; --bg-grad-1:#ffffff; --bg-grad-2:#e9edf6;
  --panel:#ffffff; --panel-2:#f3f6fc; --glass: rgba(0,0,0,0.05); --line:#cfd6e6;
  --text:#111; --muted:#555; --ok:#1a8f6e; --warn:#c58a00; --danger:#b32222;

  --icon-sun:#ffbb33;
  --icon-cloud:#666666;
  --icon-rain:#3388cc;
  --icon-snow:#777777;
  --icon-thunder:#cc8800;
  --icon-transport:#111111;
}

/* autumn */
:root[data-theme="autumn"]{
  --bg:#241410; --bg-grad-1:#402018; --bg-grad-2:#241410;
  --panel:#332018; --panel-2:#2a1712; --glass: rgba(255,200,150,0.06); --line:#52322a;
  --text:#f6eae2; --muted:#d8b8a2; --ok:#e38f5a; --warn:#ffb84d; --danger:#e05a5a;

  --icon-sun:#ff9933;
  --icon-cloud:#d8b8a2;
  --icon-rain:#e38f5a;
  --icon-snow:#f6eae2;
  --icon-thunder:#ffcc66;
  --icon-transport:#f6eae2;
}

/* NEW: red (mørk, rød aksent) */
:root[data-theme="red"]{
  --bg:#200305; --bg-grad-1:#2a0508; --bg-grad-2:#200305;
  --panel:#2d0a0d; --panel-2:#24070a; --glass: rgba(255,50,50,0.08); --line:#5a1a1f;
  --text:#fbe9ec; --muted:#dba8b1;
  --ok:#ff4d6d; --warn:#ffb84d; --danger:#ff4d4d;

  --icon-sun:#ffb84d;
  --icon-cloud:#f1c5cc;
  --icon-rain:#ff6f82;
  --icon-snow:#ffe9ec;
  --icon-thunder:#ff9966;
  --icon-transport:#fbe9ec;
}


/* ===== NSB/Vy linjefarger ===== */
.line-L1   { background:#0060a9; }
.line-L2   { background:#007f45; }
.line-L3   { background:#eb5b25; }
.line-L12  { background:#c93f3c; }
.line-L13  { background:#e57200; }
.line-L14  { background:#8b3ec9; }
.line-R10  { background:#0099a9; }
.line-R11  { background:#6b7d00; }
.line-default{ background:#374978; }

.switch {
  position: relative; display: inline-block;
  width: 46px; height: 24px;
}
.switch input { opacity: 0; width: 0; height: 0; }
.slider {
  position: absolute; cursor: pointer;
  inset: 0;
  background-color: var(--line);
  border-radius: 34px;
  transition: .3s;
}
.slider:before {
  position: absolute; content: "";
  height: 18px; width: 18px;
  left: 3px; bottom: 3px;
  background-color: white;
  border-radius: 50%;
  transition: .3s;
}
input:checked + .slider { background-color: var(--ok); }
input:checked + .slider:before { transform: translateX(22px); }

html {
  font-size: calc(16px * var(--scale-type, 1));
}

/* Myke tema-transitions */
:root, body, .card, .row, .line-pill, .badge, .icon, .header-row, .container {
  transition: 
    background-color 0.6s ease,
    background 0.6s ease,
    color 0.6s ease,
    border-color 0.6s ease,
    box-shadow 0.6s ease;
}
svg {
  transition: stroke 0.6s ease, fill 0.6s ease;
}


/* === Subtile vær-animasjoner === */

/* SOL */
@keyframes sun-rotate {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}
@keyframes sun-glow {
  0%,100% { filter: drop-shadow(0 0 0px rgba(255,255,255,0.0)); }
  50%     { filter: drop-shadow(0 0 6px rgba(255,255,255,0.25)); }
}
.wx-anim-sun .sun-rays {
  transform-origin: 12px 12px;
  animation: sun-rotate 20s linear infinite;
}
.wx-anim-sun .sun-core {
  animation: sun-glow 3.2s ease-in-out infinite;
}

/* REGN */
@keyframes cloud-drift {
  0%   { transform: translateX(0); opacity: 1; }
  50%  { transform: translateX(1.5px); opacity: 0.98; }
  100% { transform: translateX(0); opacity: 1; }
}
@keyframes drop-fall {
  0%   { transform: translateY(0); opacity: 0.95; }
  90%  { opacity: 0.75; }
  100% { transform: translateY(6px); opacity: 0; }
}

.wx-anim-rain .cloud {
  animation: cloud-drift 12s ease-in-out infinite;
}
.wx-anim-rain .rain .drop {
  animation: drop-fall 1.4s linear infinite;
}
.wx-anim-rain .rain .drop:nth-child(1){ animation-delay: 0s; }
.wx-anim-rain .rain .drop:nth-child(2){ animation-delay: .25s; }
.wx-anim-rain .rain .drop:nth-child(3){ animation-delay: .5s; }

/* SNØ */
@keyframes snow-fall {
  0%   { transform: translateY(0) translateX(0); opacity: 0.95; }
  50%  { opacity: 0.85; }
  100% { transform: translateY(6px) translateX(1.5px); opacity: 0; }
}
.wx-anim-snow .flake {
  animation: snow-fall 3.2s linear infinite;
}
.wx-anim-snow .flake:nth-child(1){ animation-delay: 0s; }
.wx-anim-snow .flake:nth-child(2){ animation-delay: 0.6s; }
.wx-anim-snow .flake:nth-child(3){ animation-delay: 1.2s; }

/* FOG */
@keyframes fog-drift {
  0%   { transform: translateX(0); opacity: 0.8; }
  50%  { transform: translateX(2px); opacity: 0.65; }
  100% { transform: translateX(0); opacity: 0.8; }
}
.wx-anim-fog .fog {
  animation: fog-drift 6s ease-in-out infinite;
}

/* Ambient myk bakgrunn når skjermsparer er aktiv */
.idle-ambient {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background:
    radial-gradient(600px 400px at 20% 30%, rgba(255,255,255,0.06), transparent 60%),
    radial-gradient(500px 360px at 80% 70%, rgba(255,255,255,0.04), transparent 60%);
  animation: idle-ambient-move 24s ease-in-out infinite alternate;
  filter: blur(0.5px);
}
@keyframes idle-ambient-move {
  0%   { transform: translate3d(0,0,0); opacity: 0.9; }
  100% { transform: translate3d(0,-6px,0); opacity: 1; }
}

/* Diskré glød inne i kortet */
.screensaver-card .idle-card-glow {
  position: absolute;
  inset: -20%;
  background:
    radial-gradient(40% 35% at 50% 30%, rgba(255,255,255,0.05), transparent 60%),
    radial-gradient(30% 25% at 30% 70%, rgba(255,255,255,0.04), transparent 60%);
  animation: idle-card-breathe 12s ease-in-out infinite;
  z-index: 0;
}
@keyframes idle-card-breathe {
  0%,100% { opacity: .7; transform: scale(1); }
  50%     { opacity: 1;  transform: scale(1.02); }
}

/* Innholdet i kortet foran gløden */
.screensaver-card > * {
  position: relative;
  z-index: 1;
}

/* —— Heartbeat (mer synlig) —— */
.heartbeat-dot{
  width: 12px; height: 12px; border-radius: 999px;
  display: inline-block;
  vertical-align: middle;
  background: var(--muted);
  border: 1px solid var(--line);
  opacity: .75;
  transition: background .25s ease, border-color .25s ease, opacity .25s ease, box-shadow .25s ease, transform .25s ease;
}

/* Fetching: blå/grønn aksent + tydelig pulserende ring */
.heartbeat-dot.is-fetching{
  background: var(--brand);
  border-color: transparent;
  opacity: 1;
  box-shadow: 0 0 0 0 rgba(143,182,255,0.45);
  animation: hb-pulse 1.2s ease-in-out infinite;
}
@keyframes hb-pulse{
  0%   { box-shadow: 0 0 0 0 rgba(143,182,255,0.45); transform: scale(1); }
  70%  { box-shadow: 0 0 0 10px rgba(143,182,255,0); transform: scale(1.06); }
  100% { box-shadow: 0 0 0 0 rgba(143,182,255,0); transform: scale(1); }
}

/* Offline: rød, rolig blink (tydelig men ikke masete) */
.heartbeat-dot.is-offline{
  background: var(--danger);
  border-color: #4a2426; /* litt dypere kant i dark */
  opacity: 1;
  animation: hb-off 1s steps(2, end) infinite;
}
@keyframes hb-off{
  0%,60% { opacity: 1; }
  100%   { opacity: .35; }
}

/* dark */
:root[data-theme="dark"]{
  /* ... eksisterende vars ... */
  --train-body: var(--icon-transport);
  --train-window: #0f1320;   /* mørk blå-svart for vinduer */
  --train-light: #ffd666;    /* varm gul */
  --train-wheel: #0b0f1c;    /* dyp mørk */
  --train-wheel-stroke: #c8d4ff; /* lys kant */
  --train-rail: #8fb6ff;     /* blålig skinne */
}

/* light */
:root[data-theme="light"]{
  /* ... eksisterende vars ... */
  --train-body: var(--icon-transport);
  --train-window: #ffffff;
  --train-light: #ffbb33;
  --train-wheel: #222222;
  --train-wheel-stroke: #ffffff;
  --train-rail: #333333;
}

/* autumn */
:root[data-theme="autumn"]{
  /* ... eksisterende vars ... */
  --train-body: var(--icon-transport);
  --train-window: #2a1712;
  --train-light: #ffb84d;
  --train-wheel: #1e120e;
  --train-wheel-stroke: #f6eae2;
  --train-rail: #e38f5a;
}

/* red */
:root[data-theme="red"]{
  /* ... eksisterende vars ... */
  --train-body: var(--icon-transport);
  --train-window: #200305;
  --train-light: #ffd36b;
  --train-wheel: #140b0d;
  --train-wheel-stroke: #f7ecee;
  --train-rail: #ff8aa1;
}
